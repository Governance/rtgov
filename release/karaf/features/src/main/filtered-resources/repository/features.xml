<?xml version="1.0" encoding="UTF-8"?>
<features>
	<repository>mvn:org.drools/drools-karaf-features/${drools.version}/xml/features</repository>

	<feature name='rtgov-common' version='${project.version}' > 
		<bundle>mvn:org.codehaus.jackson/jackson-core-asl/${version.org.codehaus.jackson}</bundle>
		<bundle>mvn:org.codehaus.jackson/jackson-mapper-asl/${version.org.codehaus.jackson}</bundle>
		<bundle>mvn:org.mvel/mvel2/${version.org.mvel}</bundle>

		<bundle>mvn:commons-configuration/commons-configuration/${version.commons-configuration}</bundle>
      		<bundle>wrap:mvn:commons-digester/commons-digester/1.8$Bundle-SymbolicName=commons-digester.commons-digester&amp;Bundle-Version=1.8&amp;Bundle-Name=Digester</bundle>
      		<bundle>mvn:commons-jxpath/commons-jxpath/1.3</bundle>
      		<bundle>wrap:mvn:jdom/jdom/1.0$Bundle-SymbolicName=jdom.jdom&amp;Bundle-Version=1.0&amp;Bundle-Name=jdom</bundle>
      		<bundle>wrap:mvn:ant/ant/1.6.5$Bundle-SymbolicName=ant.ant&amp;Bundle-Version=1.6.5&amp;Bundle-Name=ant</bundle>

		<bundle>mvn:org.overlord/overlord-commons-config/${overlord-commons.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.common/rtgov-common/${project.version}</bundle>
	</feature>
	<feature name="infinispan" version="${project.version}">
		<bundle>mvn:org.jgroups/jgroups/3.2.10.Final</bundle>
		<bundle>mvn:org.jboss.spec.javax.transaction/jboss-transaction-api_1.1_spec/1.0.1.Final</bundle>
		<bundle>mvn:org.jboss.logging/jboss-logging/3.1.2.GA</bundle>
		<bundle>mvn:org.jboss.marshalling/jboss-marshalling-osgi/1.3.16.GA</bundle>
		<bundle>wrap:mvn:org.jboss/staxmapper/1.1.0.Final$Bundle-SymbolicName=staxmapper.org.jboss&amp;Bundle-Version=1.1.0.Final&amp;Bundle-Name=StAX Mapper</bundle>
		<bundle>wrap:mvn:org.infinispan/infinispan-core/5.2.7.Final$Import-Package=javax.management,javax.naming,javax.transaction,javax.transaction.xa,javax.xml.bind,javax.xml.bind.annotation,javax.xml.bind.annotation.adapters,javax.xml.namespace,javax.xml.parsers,javax.xml.stream,javax.xml.transform,javax.xml.transform.dom,javax.xml.transform.sax,javax.xml.transform.stream,javax.xml.validation,net.jcip.annotations;resolution:=optional,org.jboss.logging;version="[3.1,4)",org.jboss.marshalling,org.jboss.marshalling.reflect,org.jboss.marshalling.river,org.jboss.marshalling.util,org.jboss.staxmapper,org.jgroups;version="[3.2,4)",org.jgroups.blocks;version="[3.2,4)",org.jgroups.blocks.mux;version="[3.2,4)",org.jgroups.jmx;version="[3.2,4)",org.jgroups.logging;version="[3.2,4)",org.jgroups.protocols;version="[3.2,4)",org.jgroups.protocols.relay;version="[3.2,4)",org.jgroups.stack;version="[3.2,4)",org.jgroups.util;version="[3.2,4)",org.osgi.framework;version="[1.6,2)";resolution:=optional,org.w3c.dom,org.xml.sax,org.xml.sax.helpers&amp;overwrite=merge</bundle>
	</feature>
	<feature name='rtgov-infinispan' version='${project.version}' > 
		<feature>rtgov-common</feature>
		<feature>infinispan</feature>

		<bundle>mvn:org.overlord.rtgov.common/rtgov-infinispan/${project.version}</bundle>
	</feature>
	<feature name='rtgov-event-processor' version='${project.version}' > 
		<feature>rtgov-common</feature>
		<feature version="${drools.version}">drools-module</feature>

		<bundle>mvn:org.overlord.rtgov.event-processor/ep-core/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.event-processor/ep-drools/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.event-processor/ep-jpa/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.event-processor/ep-mail/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.event-processor/ep-mvel/${project.version}</bundle>
	</feature>
	<feature name='rtgov-activity' version='${project.version}' > 
		<feature>rtgov-common</feature>
		<feature>rtgov-event-processor</feature>

		<bundle>wrap:mvn:jaxen/jaxen/${version.jaxen}</bundle>

		<bundle>mvn:org.overlord.rtgov.activity-management/activity/${project.version}</bundle>
	</feature>
	<feature name='rtgov-activity-server' version='${project.version}' > 
		<feature>rtgov-activity</feature>

		<bundle>mvn:org.overlord.rtgov.activity-management/activity-server-jee/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-management/activity-server-rests/${project.version}</bundle>
	</feature>
	<feature name='rtgov-event-processor-network' version='${project.version}' > 
		<feature>rtgov-common</feature>
		<feature>rtgov-infinispan</feature>
		<feature>rtgov-event-processor</feature>

		<bundle>mvn:org.overlord.rtgov.event-processor-network/epn-core/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.event-processor-network/epn-jms/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.event-processor-network/epn-jms-activemq/${project.version}</bundle>
	</feature>
	<feature name='rtgov-active-queries' version='${project.version}' > 
		<feature>rtgov-common</feature>
		<feature>rtgov-infinispan</feature>

		<bundle>mvn:org.overlord.rtgov.active-queries/active-collection/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.active-queries/active-collection-embedded/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.active-queries/active-collection-rests/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.active-queries/active-collection-infinispan/${project.version}</bundle>
	</feature>
	<feature name='rtgov-services' version='${project.version}' > 
		<feature>rtgov-common</feature>

		<bundle>mvn:org.overlord.rtgov.activity-analysis/analytics/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-analysis/call-trace/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.content.services/call-trace-rests/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-analysis/reports/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-analysis/reports-rests/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-analysis/service-dependency/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-analysis/service-dependency-svg/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.content.services/service-dependency-rests/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-analysis/situation-manager/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.content.services/situation-manager-rests/${project.version}</bundle>

		<!-- TODO: A 'reports-osgi' equivalent to 'reports-jee' -->

	</feature>
	<feature name='rtgov-activity-store-inmemory' version='${project.version}' >
		<feature>rtgov-activity</feature>

		<bundle>mvn:org.overlord.rtgov.activity-management/activity-store-mem/${project.version}</bundle>
	</feature>
	<feature name='rtgov-activity-store-jpa-h2' version='${project.version}' >
		<feature>rtgov-activity</feature>

		<bundle>mvn:org.overlord.rtgov.release.karaf.ds/activity-store-jpa-h2/${project.version}</bundle>
	</feature>
	<feature name='rtgov-server' version='${project.version}' > 
		<feature>rtgov-activity-server</feature>
		<feature>rtgov-event-processor-network</feature>
		<feature>rtgov-active-queries</feature>
		<feature>rtgov-services</feature>

		<!-- Support co-located activity collection -->
		<bundle>mvn:org.overlord.rtgov.activity-management/collector-activity-server/${project.version}</bundle>

		<!-- Activity notifier implementation to transfer stored activity events to the
		Event Processor Network -->
		<bundle>mvn:org.overlord.rtgov.activity-management/activity-server-epn/${project.version}</bundle>

		<!-- Active Collection Source implementation to receive notifications from
		Event Processor Networks -->
		<bundle>mvn:org.overlord.rtgov.active-queries/acs-epn/${project.version}</bundle>

		<!-- Co-located collection of activity events -->
		<bundle>mvn:org.overlord.rtgov.activity-management/activity-embedded/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-management/collector-activity-server/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.integration/rtgov-client/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.integration/rtgov-osgi/${project.version}</bundle>
	</feature>
	<feature name='rtgov-server-contents' version='${project.version}' > 
		<feature>rtgov-server</feature>

		<!-- Out of the box EPN/ACS -->
		<bundle>mvn:org.overlord.rtgov.content/overlord-rtgov-epn-osgi/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.content/overlord-rtgov-acs-osgi/${project.version}</bundle>
	</feature>
	<feature name='rtgov-client' version='${project.version}' > 
		<feature>rtgov-activity</feature>

		<bundle>mvn:org.overlord.rtgov.activity-management/activity-embedded/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.activity-management/collector-activity-server/${project.version}</bundle>

		<!-- Default to REST client, although this could be installed separately if other implementations -->
		<bundle>mvn:org.overlord.rtgov.activity-management/activity-server-restc/${project.version}</bundle>

		<bundle>mvn:org.overlord.rtgov.integration/rtgov-client/${project.version}</bundle>
	</feature>

	<feature name='rtgov-samples' version='${project.version}' > 
		<feature>rtgov-server</feature>

<!--
		<bundle>mvn:org.overlord.rtgov.samples.karaf.policy/samples-karaf-policy-async/${project.version}</bundle>
-->

		<bundle>mvn:org.overlord.rtgov.samples.karaf.sla/samples-karaf-sla-epn/${project.version}</bundle>

		<bundle>mvn:org.overlord.rtgov.samples.karaf.ordermgmt/samples-karaf-ordermgmt-model/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.samples.karaf.ordermgmt/samples-karaf-ordermgmt-inventoryservice/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.samples.karaf.ordermgmt/samples-karaf-ordermgmt-logisticsservice/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.samples.karaf.ordermgmt/samples-karaf-ordermgmt-orderservice/${project.version}</bundle>
		<bundle>mvn:org.overlord.rtgov.samples.karaf.ordermgmt/samples-karaf-ordermgmt-orderservice-rests/${project.version}</bundle>

	</feature>

</features>
